# Nixpacks configuration for Railway deployment
providers = ["java"]

[phases.setup]
nixPkgs = ["maven", "jdk17"]

[phases.build]
cmds = [
  "cd backend && mvn clean package -DskipTests -Dmaven.test.skip=true -U -B -e"
]

[phases.start]
cmd = "cd backend && java -XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0 -Djava.security.egd=file:/dev/./urandom -Dserver.address=0.0.0.0 -Dserver.port=$PORT -Dspring.profiles.active=railway -jar target/hr-backend-1.0.0.jar"

[variables]
MAVEN_OPTS = "-Xmx1024m"
JAVA_TOOL_OPTIONS = "-Xmx1024m"
